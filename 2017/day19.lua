input = [[                                                                                                       |                                                                                                 
   +-+   +-+                                 +-+                   +---+       +-+   +-----------------|-----------------------------------+                                             +---+   +-+ +-+ 
   | |   | |                                 | |                   |   |       | |   |                 |                                   |                                             |   |   | | | | 
   | +---+ +---------------------+           | |                   +-----------|-+   |                 |                                   |           +-------------------------------------|---|-+ | | 
   |                             |           | |                       |       |     |                 |                                   |           |                                 |   |   |   | | 
   |                       +-------------------------------------+ Y-+ | +-----|-----+                 |                                   |           |   +-----------------------------|---|---|-+ | | 
   |                       |     |           | |                 |   | | |     |                       |                                   |           |   |                             |   |   | | | | 
   +-----------------------|-----|-----------+ +-------------------+ +-+ |     +-----+         +-------------------------------------------|-----------|---|-----------------------------|---------|---+ 
                           |     |                               | |     |           |         |       |                                   |           |   |                             |   |   | | |   
                           |     |                               | |     |           |         |       |   +---------------------------------+         |   |                             |   +---+ | |   
                           |     |                               | |     |           |         |       |   |                               | |         |   |                             |         | |   
                           |     |               +-----------------|-----|-----------|---------------------+                               | |         |   |           +-----------------|---+     | |   
                           |     |               |               | |     |           |         |       |                                   | |         |   |           |                 |   |     | |   
   +-------------+     +---|-----|-------------------------------|-|-----------------|-------+ |       |                                   +---------------|-----------|---------------------|-------|-+ 
   |             |     |   |     |               |               | |     |           |       | |       |                                     |         |   |           |                 |   |     | | | 
 +-|-------------|-------+ |     |     +-----+   +---------------|---------------+   +-----+ | |     +---------------------------------------|-------------------+     |     +-----------|-+ |     | | | 
 | |             |     | | |     |     |     |                   | |     |       |         | | |     | |                                     |         |   |     |     |     |           | | |     | | | 
 | |             |     | | |     |     |     |                   | |     |       |         | +---------|-------------------------------------|-------------|-----------|-+   +-----------+ | |     | | | 
 | |             |     | | |     |     |     |                   | |     |       |         |   |     | |                                     |         |   |     |     | |                 | |     | | | 
 | |             |     | | |     |     |     |                   | |     |   +---|-------------|---------------------------------------------|---------|---|-----|-------|---------------+ | |     | | | 
 | |             |     | | |     |     |     |                   | |     |   |   |         |   |     | |                                     |         |   |     |     | |               | | |     | | | 
 | |     +---+   |     | | |     |     |     |                   | |     |   |   |         |   |     | +-------------------------------------|---------|---|-----------|-----------------|-|-|---------+ 
 | |     |   |   |     | | |     |     |     |                   | |     |   |   |         |   |     |                                       |         |   |     |     | |               | | |     | |   
 | |     |   |   |     | | |     |   +---------------------------|---------------------------+ |     |                                       |         |   |     |     | |   +-+         | | |     | |   
 | |     |   |   |     | | |     |   | |     |                   | |     |   |   |         | | |     |                                       |         |   |     |     | |   | |         | | |     | |   
 | |     |   |   |     | | |     |   | |     |               +-----|---------|---|---------|-+ |     |                                       |         |   |     |     | |   | |         | | |   +---+   
 | |     |   |   |     | | |     |   | |     |               |   | |     |   |   |         |   |     |                                       |         |   |     |     | |   | |         | | |   | |     
 | |     |   |   |     | | |     | +---------------+     +-------+ |     |   |   |         |   |     |   +---------------------------------------+     |   |     |     | |   | |         | | +-+ | |     
 | |     |   |   |     | | |     | | | |     |     |     |   |     |     |   |   O         |   |     |   |                                   |   |     |   |     |     | |   | |         | |   | | |     
 | |     |   | +-------|-|-|-----|-+ | |     |     |     |   |     |     |   |   |         |   |     |   |                                   | +---------+ |     |     | |   | |         | |   | | |     
 | |     |   | | |     | | |     |   | |     |     |     |   |     |     |   |   |         |   |     |   |                                   | | |     | | |     |     | |   | |         | |   | | |     
 | |     |   | | |     | | +---------|-------|-----|---------|-----------|-------|---------|---|-----|---------------+                       | | |     | | |     |     | +---------+     | |   | | |     
 | |     |   | | |     | |       |   | |     |     |     |   |     |     |   |   |         |   |     |   |           |                       | | |     | | |     |     |     | |   |     | |   | | |     
 +-+     |   | | |     | |       | +-|-------------+     |   | +---|-----|---------------------|---------------------+                     +---|-------|-|-|-----|-----|-----|-|---|-----|-------+ |     
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |         |   |     |   |                                 | | | |     | | |     |     |     | |   |     | |   |   |     
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |         +---|---------|-----------------------------------+ | |     | | |     |     |     | |   |     | |   |   |     
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |             |     |   |                                 |   | |     | | |     |     |     | |   |     | |   |   |     
         | +-----|-----|-------------|-|-------+         |   | |   |     |   |   |             |     |   |                                 | +-|-+     | | +-----|-----+   +-------------|-|-------+     
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   |         
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   | +-----+ 
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   | |     | 
   +-----|---|-|-------|-----------|-|-------|-|-------------|-|---|-----|---|-----------------|---------|---------------+                 | +-|-------|-|-------------------|-|---------------|-+     | 
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |               |                 |   |       | |       |         | | |   |     | |   |       | 
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |               +---------------------|-+     | |       |         | | |   |     +-|-----------+ 
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |       |   |         
   |     | | | | |     | | +---------|-|-----|-+         |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |     +---------+     
   |     | | | | |     | | |     | | | |     |           |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |     | |   |   |     
   |     +---|-----------|-----+ | | | |     |           |   | |   |     |   |   |             |   +-|---|-------------+                   |   | | +-------+     |         | | |   |     | |   |   |     
   |       | | | |     | | |   | | | | |     |           |   | |   |     |   |   |             |   | |   |             |                   |   | | |   | | |     |         | | |   |     | |   |   |     
 +-----------|---|---------|---|-------|-----|-----------------|---|-------------|-------------|---------+       +-----|-------------------|-------------|------C|---+     | | | +-|-----|-+   |   |     
 | |       | | | |     | | |   | | | | |     |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |     |   |     
 | | +-+ +-----|---------|-|---|-|-----+     |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |   +-|---|---+ 
 | | | | | | | | |     | | |   | | | |       |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   | 
 | | | | | | | | | +-------|-----|---------+ |           |   | +---|-------------------------------|-|-------+   |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   | 
 | | | | | | | | | |   | | |   | | | |     | |           |   |     |     |   |   |             |   | |       |   |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   | 
 | | | | | | | | | |   | | |   | | | |     +-|-----------|---|-----|-----|-------|-------+     |   | |       |   |     |               +-----+ | | |   | | |     |   |     | | | | |     |   | |   |   | 
 | | | | | | | | | |   | | |   | | | |       |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | |     |   |     | | | | |     |   | |   |   | 
 | | | | | | +-|-|-----|-|-|---------|-------------------|---|-----|-----|-------|-------------|-------------|-------------------------|---|---|---------|-|-+   |   |     | | | | |     |   | |   |   | 
 | | | | | |   | | |   | | |   | | | |       |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   |   |     | | | | |     |   | |   |   | 
 | | | | | |   | | +-+ | | |   | | | |     +-|---------------|-----|---------|---------------------|-|-----------|-------------------------|-|-|---|---|-|-|-|---|-+ |   +-|-+ | | |     |   | |   |   | 
 | | | | | |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   | 
 | | | +-+ |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   | 
 | | |     |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   | 
 | | |   +-|-+ | |   | | | |   | +-|-|---+ | |           |   | +---|-----|---|---|-+     |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   | 
 | | |   | | | | |   | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   | 
 | +-----+ | +-------|-|-|-----|---|-|-----------------------------|-----|---|-------------------------------|---|-----|---------------|---|---|---|---|-+ | |   | | |   | |   | | |     |   | |   |   | 
 |   |     |   | |   | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   |   | |   | | |   G |   | | |     |   | |   |   | 
 +-+ |     |   | | +---------------|-|---|-|-|-----------|---|---------------|-----|---------------|---------|---------|---------------|-------|---|---|-----|---|-|-|---|---+ | +-------|-+ | |   |   | 
   | |     |   | | | | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   |   | |   | | |   | | | |   |     | | | |   |   | 
 +-|-----+ |   | | | | | | |   |   | |   | | |           |   | +-------------+   +-------------|---|---+     |   |     |               |   | | | | |   |   | |   | | +-----|-------|-------|-------|---+ 
 | | |   | |   | | | | | | |   |   | |   | | |           |   |     |     |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | |   |     
 | | | +-|-----|-----|---------|---|-------|-----------------------|-------------------------------|---------|---|-----|---------------|---|---|-----------------|---------|-|-----|-------------+ |     
 | | | | | |   | | | | | | |   |   | |   | | |           |   |     |     |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | | +-----|-|-|-|-------|-----|-------|-----------|-----------+   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | |     | | | | | | |   |   | | +-|---|-----------------+ +-------|---------+     |     |   | | |     |   |     |           +-------+ | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | |     | | | | | | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | | +---------|---+ | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | |       | | | |   | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |     
 | | | |       | | | |   | |   |   | | | +-|-------------|-----------+   |               |     |   | | |   +-|---------------------------------|-|-----|---|-|---|-------|-|-|-|---|---------|---------+ 
 | | | |       | | | |   | |   |   | | |   | |           |   | | | |     |               |     |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   | 
 | | +---------|---|-|---|-+ +-------|-|-----------------|-----|---------|---------------|-+   |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   | 
 | |   |       | | | |   |   | |   | | |   | |           |   | | | |     |               | |   |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   | 
 | +---|-----------|---+ | +-|-|---|-|-----|-------------|---|-|---------------------------|-------|-|---------------------------------|-----|---------+   | |   | |     | | | |   |     | | | +-------+ 
 |     |       | | | | | | | | |   | | |   | |           |   | | | |     |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   | |     
 |   +-+       | | | | | | | | | +-|---|-----|-----------|-----|---|---+ |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   | +---+ 
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   |     | 
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |   +----K------|-------------------|---------------+     |   |     | | | |       | |   | |     | | | |   |     | | |   |     | 
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | |     | | | |   |     | | |   |     | 
 |   |         | | | | | | | | | | | | |   | |           |   | | | | +-|-|---------------|-----------|-|-----|---------------------------------|-------------|-----------+ | | |   |     | | |   | +-+ | 
 |   |         | | | | | | | | | | | | |   | |           |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | |       | | |   |     | | |   | | | | 
 |   |         | | | | +---|---|---|---|---|-|-+         |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | +-+   | | |   |     | | |   | | | | 
 |   |         | | | |   | | | | | | | |   | | |         |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | | 
 |   |     +---|---------|---|---------|---|-------------|-------------------|-----+     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | | 
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | | | | |   |     |     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | L 
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | | +---|---|-----------|-----|---|-------|-|---|-----|-----|---------|-----|-----|-------|-|---|---|-|-----------|---+ | | | +-|-|-+ | 
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | |   | |   |     |     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |   | | | | | | |   | 
 |   |     |   | +---+ +-----|-----|-------|-------------|-----|-|-----------------|-----------|-----------|-|---|---------+ |     |   |     | | | |       | +---|-|---|---|-------+   | | | | | | |   | 
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   |     |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |       | | | | | | |   | 
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | +-----------|---|---|-|-----|-|---------|-----------|---|-------|-|---------|---------|-|---------------+ | +-|-+ | |   | 
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |         |   |   | |   | 
 | +-|-------------|---|-|---|-|---|-|-|---|-|-|-----------------|-----|-----------|-----|-----------------|-----------|-----|---------------|-|-|---------|-----|-|-|-------|-|-------+ |   |   | |   | 
 | | |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   | 
 | | +-----|-----------|-------|---|-|---------|---------|-----|-|-------|-----------------|---|---|---------+   |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   | 
 | |       |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   |     |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   | 
 | |       |   +---|---|-----|-+ | | | |   | | +-----------------------|-----|-------------------------|---------------|---------------|-----|-|-+ |       |     | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | |   | | | |   | |           |   | | | |   | |   | |   |     | |   |   | | |   |     |     |   | |     |   |     | |   |       |     | | | |   | | |       | |   |   | |   | 
 | |       |       |   +-|-|-|---|-|---------|-----------|-------|-----|-----|---------------+ |   | | |   |     +-----------|-----|---|---+ | |   +---------+   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | |   | |   |     | | | |   | | |   |           |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | +-|-|---|-----------|-----------+           |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   +---------+ | | |   | | +---------|-------+ |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | |     | | |   | | |         |   | |   |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | | +---|---|---|-----------------|-|-------|-------|---|-----------|---|---+               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   | 
 | |       |       |   | | | | |   | | |   | | |         |   | |   | +---|-----|---------|-|-|-|---|-------------------|-----------|-------|-----------------|-----|---------|-+       | |   |   | |   | 
 | |       |       |   | | | | |   | | |   | | |         |   | |   | | | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | |         | |   |   | |   | 
 | +-+     |       |   +-|---------|---|-----|-|---------|---|-|-----------|-|-|---------|-+ | |   | |                 |   | |     +---|-----+ |           | |   | | | | +-|---+       | |   |   | |   | 
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |         |   |   |           | |   | | | | | | | |       | |   |   | |   | 
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |         +---|-----------------|-----------|-|---|-------|-----|-----|---+ 
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | | |       | |   |   | |     
 | +-----+ |       |     | +---------------------+       |   | |   +---|---|-|-----------|---|-|---|-|-----------------------|-------------|---------------|---------|-|-|-|---+       | |   |   | |     
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 | | |   | |       |     |   | |   | | |   | | | |       |   +-------------|-|-|---|---------|-|-----|-----------+     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 | | |   | |       |     |   | |   | | |   | | | |       |     |     | | | | | |   |     |   | |   | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 | +-------|-------|-----|---|-----|-|-----|-+ | |       | +---|---+ | | | | +-|---------|---|---+ | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   | +---|---|---|---|-|-------------|---------|-----|---|-----|---|-----|-|-----------|---------|-------+       |   |           | |   | | | | | | |         | |   |   | |     
 |   |   | |       |     |   |     | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |     |       |   |           | |   | | | | | | |         | |   |   | |     
 |   |   +-------+ |     |   |     | | |   |   | +-------|-|---|---|---|---|---|---------|-----|-|---|-------------+   |   | +-----|-------|---|-+   +-----|-------|-----+ | |         | |   |   | |     
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   |       |       |   | |   |     | |   | | | |   | |         | |   |   | |     
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | +-----+       |   | +---|-+   | |   | +-|-|---------------|-+   |   | |     
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |     | |   | |   |   | |   | |         |     |   | |     
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |     +-|---|-|---|---|-------|-----+   |     |   | |     
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |     |   |     |   | |     
 |   |     |   +-|-|---------|-------|-------------------------------------|---|-----------------------------------|---|---|-|-------------------------|---|---------|-----|-|-----|---|---------|-|---+ 
 |   |     |   | | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |     |   |     |   | |   | 
 |   |     |   | | |     +---------|---|-------------------|---------------|---|---------|-----|-------------------|-------|---------------------------|-----|---|---|-|---------+ |   |     |   | |   | 
 |   |     |   | | |         |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |   | |   |     |   | |   | 
 |   |     |   | | |         |     | | |   |   |         | | +-----------------|---|-----|---|-----|-|-----------|-----|-----+             |   |       |   | |   |   | |   | |   | |   |     |   | |   | 
 |   |     |   | | |         |     | | |   |   |         | | | |   | | | | |   |   |     |   | | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | |   |     |   | |   | 
 |   |     |   | +-|-----+   |     | | |   |   |         | | | |   | | | | |   |   |   +-----|-|-----|-------------|---|-----------------------------------|-|-+ |   | |   | |   | |   |     |   | |   | 
 |   |     |   |   |     |   |     | | |   |   |         | | | |   | | | | |   |   |   | |   | | | | |           | |   |   |               |   |       |   | | | |   | |   | |   | |   |     |   | |   | 
 |   |     |   | +-|-----+   |     +-------|---|-----------|-|---------|---|---+   |   | |   | | | | |           | |   |   |               |   |       |   | | +-|-----|---|-|-------+ |     |   | |   | 
 |   |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |   | | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   | 
 +---|---------|---|-----------------|-----|---|---------|-|-|-----|---|-----------------|---+ | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   | 
     |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   | 
     |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | +-|-|-----|---|---+ | 
     |     X   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   |   | |     |   | | | | 
     |     |   | | |         |       | |   |   |         | | | +-----|-|---|-------+   | |     | | | |           | |   |   |               |   |   +---+   | |   |   | |   | |   |   | |     |   | | | | 
     |     |   | | |         |       | |   |   |         | | |     | | | | |           | |     | | | |           | |   |   |               |   |   |       | |   |   | |   | |   |   | |     |   | | | | 
     |     |   | +-|-----------------|-------------------|-|-------|---|A|-|---+       | |     | +---|-----------|-|---|---|---------------|---|---|-------|-|-+ |   | |   | |   |   | |     |   | | +-+ 
     |     |   |   |         |       | |   |   |         | | |     | | | | |   |       | |     |   | |           | |   |   |               |   |   |       | | | |   | |   | |   |   | |     |   | |     
     |     |   | +---------------------|---------------------|-------|-|---+   |       | |     |   | |           | |   |   |               +---------------|-+ | +---|-|---|-----|-----|-----|-----|-+   
     |     |   | | |         |       | |   |   |         | | |     | | | |     |       | |     |   | |           | |   |   |                   |   |       |   |     | |   | |   |   | |     |   | | |   
     |     |   | | |         | +-----|-----|-----------------------------|---------------|-----|-----|-------------|---|-----------------------|---|-------|---|---+ | +---+ +---|---|-|---+ |   | | |   
     |     |   | | |         | |     | |   |   |         | | |     | | | |     |       | |     |   | |           | |   |   |                   |   |       |   |   | |           |   | |   | |   | | |   
     |     |   | | |         | +-----------|-------------|-+ +-+   +-|-|-------+       | |     |   | |           | |   |   |                   |   |       |   |   | |       +---|-----|-+ | |   | | |   
     |     |   | | |         |       | |   |   |         |     |     | | |             | |     |   | |           | |   |   |                   |   |       |   |   | |       |   |   | | | | |   | | |   
     |     |   | +-|---------|-------|-------------------------------|-|-----------------------|-----|-----------|-|---|---|-----------------------|-------|-------|-----+   +-----+ | | | | |   | | |   
     |     |   |   |         |       | |   |   |         |     |     | | |             | |     |   | |           | |   |   |                   |   |       |   |   | |   |       | | | | | | |   | | |   
     |     |   |   |         | +-----|-|-------|---------|-----|---------|---------------|-----+   | |           | |   |   |                   |   |   +---|-+ |   | |   |       | | | | +-------|-+ |   
     |     |   |   |         | |     | |   |   |         |     |     | | |             | |         | |           | |   |   |                   |   |   |   | | |   | |   |       | | | |   | |   |   |   
     |     |   |   |         | | +---------|---|---------------------|---|-------------------------+ |           | |   |   | +-----------------|---|---|---|-+ | +-|---+ |   +-+ | | | |   | |   |   |   
     |     |   |   |         | | |   | |   |   |         |     |     | | |             | |           |           | |   |   | |                 |   |   |   |   | | | | | |   | | | | | |   | |   |   |   
     |     |   |   |         | | |   | |   |   |         |     |     | | |             +-|-----------|-----------------|---------------------------|---|---|-+ +---|-|-|-+   +---+ | +-------|---|---|-+ 
     |     |   |   |         | | |   | |   |   |         |     |     | | |               |           |           | |   |   | |                 |   |   |   | |   | | | |       |   |   |   | |   |   | | 
     |     |   |   |         | | +-+ +-----|---|---------------|---------|---------------|-----+     +-----------+ +-------|-----------------------|---+   | |   | | | +---+   |   |   | +---|---+   | | 
     |     |   |   W         | |   |   |   |   |         |     |     | | |               |     |                       |   | |                 |   |       | |   | | |     |   |   |   | | | |       | | 
   +-------|---|---|---------|-|-----------|-------------------|-------|-----------------|-----|-----------------------|---|-|-----------------|-------------|---|---|-------------|---+ | | |       | | 
   | |     |   |   |         | |   |   |   |   |         |     |     | | |               |     |                       |   | |                 |   |       | |   | | |     |   |   |     | | |       | | 
   | |     +-----------------|-|---|-------|-------------+     |     | | |               |     |                       |   | |           +-----|-----------------|-|------R|---|---+     | | |       | | 
   | |         |   |         | |   |   |   |   |               |     | | |               |     |                       |   | |           |     |   |       | |   | | |     |   |         | | |       | | 
   | +-------------|---------+ |   |   |   +---|---------------|-------|-+               +-----------------------------|-----+           |     |   +-+     | |   | | |     +---+         | +-|-+     | | 
   |           |   |           |   |   |       |               |     | |                       |                       |   |             |     |     |     | |   | | |                   |   | |     | | 
 +-+           +-----------------------------------------------|-----|-----------------+       |                       |   +-+           |     |     |     +-+   | | | +-----------------|-------------+ 
 |                 |           |   |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |                 |   | |     |   
 +-----------------------------|-------|-------|---------------------------------------|-------|-----------------------|-----|-----------|-----|-----------------|-----|---------------+ |   | |     |   
                   |           |   |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |               | |   | |     |   
                   |           +---|-----------|-----------------------|---------------|-------|-----------------------|-----------------------------|-------------|-|-|---------------|-+   | |     |   
                   |               |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |               |     | |     |   
                   |               |   |       |               +-----|-|---------------+       |                       +-----------------------------|-----------|-|-|-----------------|-------------+   
                   |               |   |       |                     | |                       |                             |           |     |     |           | | | |               |     | |         
                   |               |   |       +---------------------+ +-----------------------|-----------------------------|-----------------|---------------------|-----------------|-------+         
                   |               |   |                                                       |                             |           |     |     |           | | | |               |     |           
                   +---------------+   +-------------------------------------------------------+                             +-----------+     +-----+           +-+ +-+               +-----+           
                                                                                                                ]]
line = 1
for i = 1, #input do
	local str = string.sub(input, i, i)
	if str == "|" then
		pos = i
		break
	end
end
function getmap(input)
	local t = {}
	local jump = string.find(input, string.char(10))
	local i = 1
	while jump do
		local str = string.sub(input, i, jump - 1)
		table.insert(t, str)
		i = jump + 1
		jump = string.find(input, string.char(10), i)
	end
	if i <= #input then
		local str = string.sub(input, i, #input)
		table.insert(t, str)
	end
	return t
end
map = getmap(input)
direction = "down"
collection = {}
function collect(pos, con, linecont)
	local str = string.sub(linecont, pos, pos)
	local col = string.match(str, "%a")
	if col then
		table.insert(con,col)
	end
end
function rotate(line, pos, dir, precont, cont, poscont)
	local str = string.sub(cont, pos, pos)
	if not (str == "+") then return dir end
	local adir = {}
	if precont and not (dir == "down") then table.insert(adir,"up") end
	if cont then
		if pos > 1 and not (dir == "right") then table.insert(adir,"left") end
		if pos < #cont and not (dir == "left") then table.insert(adir,"right") end
	end
	if poscont and not (dir == "up") then table.insert(adir,"down") end
	for i, s in pairs(adir) do
		if s == "up" then
			local cstr = string.sub(precont, pos, pos)
			if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
				return "up"
			end
		elseif s == "left" then
			local cstr = string.sub(cont, pos - 1, pos - 1)
			if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
				return "left"
			end
		elseif s == "down" then
			local cstr = string.sub(poscont, pos, pos)
			if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
				return "down"
			end
		elseif s == "right" then
			local cstr = string.sub(cont, pos + 1, pos + 1)
			if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
				return "right"
			end
		end
	end
	return dir
end
function move(line, pos, dir, precont, cont, poscont)
	if dir == "up" then
		local cstr = string.sub(precont, pos, pos)
		if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
			return line - 1, pos, false
		end
	elseif dir == "left" then
		local cstr = string.sub(cont, pos - 1, pos - 1)
		if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+")then
			return line, pos - 1, false
		end
	elseif dir == "down" then
		local cstr = string.sub(poscont, pos, pos)
		if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
			return line + 1, pos, false
		end
	elseif dir == "right" then
		local cstr = string.sub(cont, pos, pos)
		if string.match(cstr, "%a") or string.match(cstr, "%d") or (cstr == "-") or (cstr == "|") or (cstr == "+") then
			return line, pos + 1, false
		end			
	end
	return line, pos, true
end
i = 0
while (line >= 1 and line <= #map) and (pos >= 1 and pos <= #map[line]) do
	--get the content of line, also previous and pos (if any)
	local precont, cont, poscont
	if line > 1 then
		precont = map[line - 1]
	end
	cont = map[line]
	if line < #map then
		poscont = map[line + 1]
	end
	--collect
	collect(pos, collection, cont)
	--rotate
	direction = rotate(line, pos, direction, precont, cont, poscont)
	--advance
	line, pos, stop = move(line, pos, direction, precont, cont, poscont)
	i = i + 1 -- counting end only (i = 0) == counting start only (i = 1) [1 - 1]
	if stop then break end
end
str = ""
for i, s in pairs(collection) do
	str = str .. s
	print(i, s)
end
print("leters:",str)
print("it was " .. i .. " steps")
